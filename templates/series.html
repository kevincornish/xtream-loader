{% extends "base.html" %} {% block title %}Series - Xtream Loader{% endblock %}
{% block content %}
<h1 class="text-3xl font-bold mb-6">Series</h1>
<div
  class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-8"
  role="alert"
>
  <p><strong>Data Fetched:</strong> {{ fetch_time }}</p>
  <p><strong>Will Refresh In:</strong> {{ refresh_time }}</p>
</div>

<div class="mb-4">
  <a
    href="/series?force_refresh=true"
    class="inline-block bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mr-2"
  >
    Force Refresh Categories
  </a>
  <a
    href="/series/refresh-all"
    class="inline-block bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"
  >
    Force Refresh All Series
  </a>
</div>

{% if all_series_refreshed %}
<div
  class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-8"
  role="alert"
>
  All series data has been refreshed. Icon caching is in progress and may take
  some time to complete.
</div>
{% endif %}

<div id="series-categories" class="space-y-4 mt-4">
  {% for category in series_categories %}
  <div class="bg-white shadow-md rounded-lg p-4">
    <h3 class="text-xl font-semibold mb-2">
      {{ category.category_name }} (ID: {{ category.category_id }})
    </h3>
    <button
      hx-get="/series-category/{{ category.category_id }}"
      hx-target="#content-series-{{ category.category_id }}"
      hx-indicator="#indicator-series-{{ category.category_id }}"
      class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"
    >
      Load Series
    </button>
    <button
      hx-get="/series-category/{{ category.category_id }}?force_refresh=true"
      hx-target="#content-series-{{ category.category_id }}"
      hx-indicator="#indicator-series-{{ category.category_id }}"
      class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded"
    >
      Force Refresh
    </button>
    <button
      hx-get="/empty"
      hx-target="#content-series-{{ category.category_id }}"
      class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded"
    >
      Close
    </button>
    <div
      id="indicator-series-{{ category.category_id }}"
      class="htmx-indicator"
    >
      Loading...
    </div>
    <div id="content-series-{{ category.category_id }}" class="mt-4"></div>
  </div>
  {% endfor %}
</div>
{% endblock %}
